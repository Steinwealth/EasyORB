# Risk Management Configuration
# =============================
# Easy ORB Strategy - Unified Configuration System (65+ configurable settings)
# Last updated: 2026-01-06 (Rev 00231)

# Portfolio Risk Limits
MAX_PORTFOLIO_RISK_PCT=80.0
MAX_SINGLE_POSITION_RISK_PCT=35.0
MAX_CORRELATED_POSITIONS=3

# Daily Risk Limits
MAX_DAILY_LOSS_PCT=5.0
MAX_DAILY_TRADES=200
MAX_DAILY_VOLUME_PCT=10.0

# Weekly Risk Limits
MAX_WEEKLY_LOSS_PCT=5.0
MAX_WEEKLY_LOSS_AMOUNT=5000.0
MAX_WEEKLY_TRADES=200
MAX_WEEKLY_VOLUME_PCT=25.0

# Monthly Risk Limits
MAX_MONTHLY_LOSS_PCT=10.0
MAX_MONTHLY_LOSS_AMOUNT=20000.0
MAX_MONTHLY_TRADES=500
MAX_MONTHLY_VOLUME_PCT=50.0

# Position Risk Management (OPTIMIZED FOR MAXIMUM PROFIT CAPTURE)
STOP_LOSS_ENABLED=true
STOP_LOSS_ATR_MULTIPLIER=1.5
STOP_LOSS_PCT=3.0              # Increased from 2% to 3% for better entries
TRAILING_STOP_ENABLED=true
TRAILING_STOP_ATR_MULTIPLIER=2.0
TAKE_PROFIT_ENABLED=true
TAKE_PROFIT_ATR_MULTIPLIER=3.0
TAKE_PROFIT_PCT=5.0            # Increased from 4% to 5% base take profit

# Optimized Stealth Trailing Parameters (Rev 00196 - OPTIMIZED FOR MAXIMUM PROFIT CAPTURE)
STEALTH_BREAKEVEN_THRESHOLD=0.0075   # 0.75% breakeven threshold (Rev 00196: optimized from 0.5% to 0.75% based on historical data analysis - median activation P&L)
STEALTH_MIN_BREAKEVEN_ACTIVATION_MINUTES=6.4  # Rev 00196: optimized from 3.5 to 6.4 minutes (median activation time)
STEALTH_BASE_TRAILING=0.015         # 1.5% base trailing distance (matches Strategy.md)
STEALTH_MIN_TRAILING=0.010          # 1.0% minimum trailing (matches Strategy.md)
STEALTH_MAX_TRAILING=0.025          # 2.5% maximum trailing (matches Strategy.md)
STEALTH_BREAKEVEN_OFFSET=0.002      # 0.2% offset above breakeven
STEALTH_MIN_PROFIT_FOR_TRAILING=0.007  # 0.7% profit activates trailing (Rev 00196: optimized from 0.5% to 0.7% - 91.1% profit capture vs 75.4% at 0.5%)
STEALTH_MIN_TRAILING_ACTIVATION_MINUTES=6.4  # Rev 00196: optimized from 3.5 to 6.4 minutes (median activation time)

# Rev 00201: Additional Configurable Settings (Previously Hardcoded)
STEALTH_EXPLOSIVE_TRAILING=0.040  # 4.0% for explosive moves
STEALTH_MOMENTUM_GAIN_THRESHOLD=0.003  # +0.3% in 15 min = explosive
STEALTH_MOMENTUM_LOOKBACK_MINUTES=15.0  # Check last 15 minutes
STEALTH_TRENDING_TAKE_PROFIT=0.12  # 12% trending moves

# RSI-based exit thresholds (Rev 00201)
STEALTH_RSI_EXIT_THRESHOLD=45.0  # RSI < 45 triggers exit check
STEALTH_RSI_EXIT_CONSECUTIVE_TICKS=3  # 3 consecutive ticks required

# Portfolio health check thresholds (Rev 00201)
STEALTH_HEALTH_CHECK_WIN_RATE_THRESHOLD=35.0  # <35% win rate = red flag
STEALTH_HEALTH_CHECK_AVG_PNL_THRESHOLD=-0.005  # <-0.5% avg P&L = red flag
STEALTH_HEALTH_CHECK_MOMENTUM_THRESHOLD=40.0  # <40% momentum = red flag
STEALTH_HEALTH_CHECK_PEAK_THRESHOLD=0.008  # <0.8% avg peak = red flag

# Rapid exit thresholds (Rev 00201)
STEALTH_RAPID_EXIT_NO_MOMENTUM_MINUTES=15.0  # 15 minutes
STEALTH_RAPID_EXIT_NO_MOMENTUM_PEAK=0.003  # <0.3% peak
STEALTH_RAPID_EXIT_IMMEDIATE_START=5.0  # 5 minutes
STEALTH_RAPID_EXIT_IMMEDIATE_END=10.0  # 10 minutes
STEALTH_RAPID_EXIT_IMMEDIATE_PNL=-0.005  # <-0.5% P&L
STEALTH_RAPID_EXIT_WEAK_MINUTES=20.0  # 20 minutes
STEALTH_RAPID_EXIT_WEAK_PNL=-0.003  # <-0.3% P&L
STEALTH_RAPID_EXIT_WEAK_PEAK=0.002  # <0.2% peak

# Time-based thresholds (Rev 00201)
STEALTH_TIME_WEIGHTED_PEAK_FIRST_HOUR=60.0  # First hour
STEALTH_TIME_WEIGHTED_PEAK_SECOND_HOUR=120.0  # Second hour
STEALTH_RAPID_EXIT_TIME_LIMIT_MINUTES=30.0  # Rapid exits only apply for first 30 minutes

# Rev 00213: Minimum holding time for profitable positions (prevent premature exits)
STEALTH_MIN_HOLD_MINUTES_PROFITABLE=15.0  # Minimum 15 minutes before allowing stop loss exit on profitable positions

# Rev 00214: Minimum profit threshold before allowing stop loss exit on profitable positions
STEALTH_MIN_PROFIT_FOR_STOP_EXIT=0.003  # 0.3% minimum profit before allowing stop loss exit

# Rev 00215: Minimum sustained profit time before activating breakeven (prevent activation on brief spikes)
STEALTH_MIN_BREAKEVEN_SUSTAINED_MINUTES=2.0  # 2 minutes minimum sustained profit before breakeven activates

# Rev 00156: Volatility-Based Trailing Tiers (CONFIGURABLE - All Settings Adjustable)
STEALTH_TRAILING_VOL_EXTREME=0.025      # 2.5% trailing for >6% volatility
STEALTH_TRAILING_VOL_HIGH=0.020         # 2.0% trailing for 3-6% volatility
STEALTH_TRAILING_VOL_MODERATE=0.0175    # 1.75% trailing for 2-3% volatility
STEALTH_TRAILING_VOL_LOW=0.015          # 1.5% trailing for <2% volatility
STEALTH_VOL_THRESHOLD_EXTREME=6.0       # 6% volatility threshold
STEALTH_VOL_THRESHOLD_HIGH=3.0          # 3% volatility threshold
STEALTH_VOL_THRESHOLD_MODERATE=2.0      # 2% volatility threshold

# Rev 00156: Profit-Based Trailing Tiers (CONFIGURABLE - All Settings Adjustable)
STEALTH_TRAILING_PROFIT_MAX=0.015       # 1.5% trailing for 12%+ profit
STEALTH_TRAILING_PROFIT_HIGH=0.020      # 2.0% trailing for 7-12% profit
STEALTH_TRAILING_PROFIT_MEDIUM=0.025    # 2.5% trailing for 3-7% profit
STEALTH_PROFIT_THRESHOLD_MAX=0.12       # 12% profit threshold
STEALTH_PROFIT_THRESHOLD_HIGH=0.07      # 7% profit threshold
STEALTH_PROFIT_THRESHOLD_MEDIUM=0.03    # 3% profit threshold

# Rev 00156: Entry Bar Protection Tiers (CONFIGURABLE - All Settings Adjustable)
STEALTH_ENTRY_BAR_PROTECTION_EXTREME=0.080  # 8% protection for >6% volatility
STEALTH_ENTRY_BAR_PROTECTION_HIGH=0.050     # 5% protection for 3-6% volatility
STEALTH_ENTRY_BAR_PROTECTION_MODERATE=0.030 # 3% protection for 2-3% volatility
STEALTH_ENTRY_BAR_PROTECTION_LOW=0.020      # 2% protection for <2% volatility
STEALTH_ENTRY_BAR_PROTECTION_MINUTES=30.0   # Protection duration (minutes)

# Rev 00156: Gap Risk Tiers (CONFIGURABLE - All Settings Adjustable)
STEALTH_GAP_RISK_EXTREME=0.060          # 6.0% gap threshold for >6% volatility
STEALTH_GAP_RISK_HIGH=0.050             # 5.0% gap threshold for 3-6% volatility
STEALTH_GAP_RISK_MODERATE=0.040         # 4.0% gap threshold for 2-3% volatility
STEALTH_GAP_RISK_LOW=0.030              # 3.0% gap threshold for <2% volatility

# Rev 00156: Stealth Offset (CONFIGURABLE - All Settings Adjustable)
STEALTH_OFFSET_MULTIPLIER=0.1           # 10% of trailing distance
STEALTH_OFFSET_MULTIPLIER_ACTIVE=0.05   # 5% when trailing active

# Rev 00156: Other Thresholds (CONFIGURABLE - All Settings Adjustable)
STEALTH_DEFAULT_ENTRY_BAR_VOLATILITY=2.0    # Default entry bar volatility %
STEALTH_AVG_PNL_THRESHOLD_AGGRESSIVE=-0.005 # -0.5% for aggressive booting
STEALTH_PROFIT_PROTECTION_THRESHOLD=0.005   # 0.5% profit protection
STEALTH_LOSS_THRESHOLD=-0.002               # -0.2% loss threshold

# Volatility Risk Management
MAX_VOLATILITY_THRESHOLD=0.05
MIN_VOLATILITY_THRESHOLD=0.01
VOLATILITY_ADJUSTED_SIZING=true
ATR_BASED_STOPS=true
ATR_PERIOD=14

# Liquidity Risk Management
MIN_AVERAGE_VOLUME=100000
MIN_BID_ASK_SPREAD_PCT=0.1
MAX_BID_ASK_SPREAD_PCT=2.0
MIN_SHARES_AVAILABLE=1000

# Market Risk Management
MARKET_CAP_MIN=1000000000
MARKET_CAP_MAX=1000000000000
PRICE_MIN=5.0
PRICE_MAX=1000.0
SECTOR_DIVERSIFICATION=true

# Time Risk Management
MAX_POSITION_HOLD_HOURS=24
MAX_POSITION_HOLD_DAYS=5
AUTO_CLOSE_AT_MARKET_CLOSE=true
AUTO_CLOSE_ON_FRIDAY=true

# Correlation Risk Management
MAX_CORRELATION_THRESHOLD=0.7
CORRELATION_CHECK_ENABLED=true
DIVERSIFICATION_REQUIRED=true
MIN_DIVERSIFICATION_SCORE=0.5

# Drawdown Risk Management
MAX_DRAWDOWN_PCT=5.0
MAX_CONSECUTIVE_LOSSES=5
MAX_CONSECUTIVE_WINS=10
DRAWDOWN_RECOVERY_MODE=true

# Cash Management
# Rev 00102: Capital allocation in configs/strategies.env (SINGLE SOURCE OF TRUTH)
# SO_CAPITAL_PCT=90, CASH_RESERVE_PCT=10, ORR_CAPITAL_PCT=0
CASH_RESERVE_THRESHOLD=1000.0
MARGIN_USAGE_ENABLED=false

# Emergency Controls
EMERGENCY_STOP_ENABLED=true
EMERGENCY_STOP_LOSS_PCT=10.0
EMERGENCY_STOP_TRIGGER=manual
AUTO_EMERGENCY_STOP=false

# Risk Monitoring
RISK_MONITORING_ENABLED=true
REAL_TIME_RISK_CALCULATION=true
RISK_ALERTS_ENABLED=true
RISK_REPORTING_ENABLED=true

# Risk Metrics
VAR_CALCULATION_ENABLED=true
VAR_CONFIDENCE_LEVEL=0.95
VAR_TIME_HORIZON=1
STRESS_TESTING_ENABLED=true
SCENARIO_ANALYSIS_ENABLED=true

# Compliance
REGULATORY_COMPLIANCE=true
POSITION_LIMITS_ENFORCED=true
CONCENTRATION_LIMITS_ENFORCED=true
REPORTING_REQUIREMENTS=true

# Position Sizing Configuration (OPTIMIZED FOR MAXIMUM PROFIT CAPTURE)
BASE_POSITION_SIZE_PCT=10.0  # 10% base position size to match Live Mode
MAX_POSITION_SIZE_PCT=35.0   # Maximum position size after all boosts
MIN_POSITION_SIZE_PCT=1.0
MIN_POSITION_VALUE=50.0

# Rev 00102: Capital allocation in configs/strategies.env (SINGLE SOURCE OF TRUTH)
# SO_CAPITAL_PCT=90, CASH_RESERVE_PCT=10, ORR_CAPITAL_PCT=0
POSITION_SPLITTING_ENABLED=true

# Strategy Agreement Bonuses
AGREEMENT_MEDIUM_BONUS=0.25
AGREEMENT_HIGH_BONUS=0.50
AGREEMENT_MAXIMUM_BONUS=1.00

# Profit-Based Scaling
PROFIT_SCALING_200_PCT_MULTIPLIER=1.8
PROFIT_SCALING_100_PCT_MULTIPLIER=1.4
PROFIT_SCALING_50_PCT_MULTIPLIER=1.2
PROFIT_SCALING_25_PCT_MULTIPLIER=1.1

# Win Streak Boosting
WIN_STREAK_ENABLED=true
WIN_STREAK_BASE_MULTIPLIER=1.0
WIN_STREAK_MAX_MULTIPLIER=2.0
WIN_STREAK_TRACKING_DAYS=30

# Risk Limits by Strategy (Updated to 10% cap with confidence boosts)
STANDARD_STRATEGY_RISK_PCT=10.0
ADVANCED_STRATEGY_RISK_PCT=10.0
QUANTUM_STRATEGY_RISK_PCT=10.0

# Confidence-Based Position Sizing (OPTIMIZED FOR BIGGER POSITIONS)
ULTRA_HIGH_CONFIDENCE_THRESHOLD=0.95  # Lowered from 0.995 to 0.95 for more opportunities
HIGH_CONFIDENCE_THRESHOLD=0.90        # Lowered from 0.95 to 0.90 for more opportunities
MEDIUM_CONFIDENCE_THRESHOLD=0.85      # Lowered from 0.90 to 0.85 for more opportunities
ULTRA_HIGH_CONFIDENCE_MULTIPLIER=2.5  # Increased from 1.5 to 2.5x for explosive moves
HIGH_CONFIDENCE_MULTIPLIER=2.0        # Increased from 1.2 to 2.0x for trending moves
MEDIUM_CONFIDENCE_MULTIPLIER=1.0

# Trade Ownership Isolation
POSITION_ISOLATION_ENABLED=true
BOT_TAG=EES
IGNORE_MANUAL_POSITIONS=true

# Risk Limits by Symbol
HIGH_VOLATILITY_SYMBOLS_RISK_PCT=1.0
MEDIUM_VOLATILITY_SYMBOLS_RISK_PCT=2.0
LOW_VOLATILITY_SYMBOLS_RISK_PCT=3.0

# Risk Limits by Market Condition
BULL_MARKET_RISK_PCT=3.0
BEAR_MARKET_RISK_PCT=1.0
SIDEWAYS_MARKET_RISK_PCT=2.0
VOLATILE_MARKET_RISK_PCT=1.5

# Alert Thresholds
RISK_ALERT_THRESHOLD_1=50.0
RISK_ALERT_THRESHOLD_2=75.0
RISK_ALERT_THRESHOLD_3=90.0
RISK_ALERT_THRESHOLD_4=95.0

# Risk Adjustment
DYNAMIC_RISK_ADJUSTMENT=true
PERFORMANCE_BASED_RISK=true
MARKET_CONDITION_RISK=true
VOLATILITY_ADJUSTED_RISK=true
